<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.9.1" xml:lang="en-US">
  <compounddef id="embedding__cache_8hpp" kind="file" language="C++">
    <compoundname>embedding_cache.hpp</compoundname>
    <includes local="no">cuda_runtime_api.h</includes>
    <includes refid="embedding_8h" local="no">wholememory/embedding.h</includes>
    <includes refid="wholememory__tensor_8h" local="no">wholememory/wholememory_tensor.h</includes>
    <includedby refid="embedding__cache_8cpp" local="yes">src/wholememory/embedding_cache.cpp</includedby>
    <includedby refid="embedding__optimizer_8hpp" local="yes">src/wholememory/embedding_optimizer.hpp</includedby>
    <includedby refid="embedding__cache__func_8h" local="yes">src/wholememory_ops/functions/embedding_cache_func.h</includedby>
    <incdepgraph>
      <node id="6">
        <label>stdint.h</label>
      </node>
      <node id="7">
        <label>stdlib.h</label>
      </node>
      <node id="9">
        <label>wholememory/wholememory.h</label>
        <link refid="wholememory_8h"/>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
      </node>
      <node id="13">
        <label>stddef.h</label>
      </node>
      <node id="4">
        <label>wholememory/env_func_ptrs.h</label>
        <link refid="env__func__ptrs_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
      </node>
      <node id="11">
        <label>unistd.h</label>
      </node>
      <node id="3">
        <label>wholememory/embedding.h</label>
        <link refid="embedding_8h"/>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="8" relation="include">
        </childnode>
      </node>
      <node id="8">
        <label>wholememory/wholememory_tensor.h</label>
        <link refid="wholememory__tensor_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
      </node>
      <node id="2">
        <label>cuda_runtime_api.h</label>
      </node>
      <node id="12">
        <label>wholememory/global_reference.h</label>
        <link refid="global__reference_8h"/>
        <childnode refid="13" relation="include">
        </childnode>
      </node>
      <node id="1">
        <label>src/wholememory/embedding_cache.hpp</label>
        <link refid="embedding__cache_8hpp"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="8" relation="include">
        </childnode>
      </node>
      <node id="5">
        <label>wholememory/tensor_description.h</label>
        <link refid="tensor__description_8h"/>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
      </node>
      <node id="10">
        <label>stdio.h</label>
      </node>
    </incdepgraph>
    <invincdepgraph>
      <node id="3">
        <label>src/wholememory/embedding_optimizer.hpp</label>
        <link refid="embedding__optimizer_8hpp"/>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
      </node>
      <node id="5">
        <label>src/wholememory/embedding.hpp</label>
        <link refid="embedding_8hpp"/>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
      </node>
      <node id="6">
        <label>src/wholememory/embedding_optimizer.cpp</label>
        <link refid="embedding__optimizer_8cpp"/>
      </node>
      <node id="4">
        <label>src/wholememory/embedding.cpp</label>
        <link refid="embedding_8cpp"/>
      </node>
      <node id="2">
        <label>src/wholememory/embedding_cache.cpp</label>
        <link refid="embedding__cache_8cpp"/>
      </node>
      <node id="7">
        <label>src/wholememory_ops/functions/embedding_cache_func.h</label>
        <link refid="embedding__cache__func_8h"/>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="2" relation="include">
        </childnode>
      </node>
      <node id="1">
        <label>src/wholememory/embedding_cache.hpp</label>
        <link refid="embedding__cache_8hpp"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
      </node>
    </invincdepgraph>
    <innerclass refid="structwholememory__embedding__cache__policy__" prot="public">wholememory_embedding_cache_policy_</innerclass>
    <innerclass refid="classwholememory_1_1embedding__cache__local__data" prot="public">wholememory::embedding_cache_local_data</innerclass>
    <innerclass refid="classwholememory_1_1embedding__cache__base" prot="public">wholememory::embedding_cache_base</innerclass>
    <innerclass refid="classwholememory_1_1device__cache__for__host" prot="public">wholememory::device_cache_for_host</innerclass>
    <innerclass refid="classwholememory_1_1local__cache__for__global" prot="public">wholememory::local_cache_for_global</innerclass>
    <innernamespace refid="namespacewholememory">wholememory</innernamespace>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">/*</highlight></codeline>
<codeline lineno="2"><highlight class="comment"><sp/>*<sp/>Copyright<sp/>(c)<sp/>2019-2023,<sp/>NVIDIA<sp/>CORPORATION.</highlight></codeline>
<codeline lineno="3"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="4"><highlight class="comment"><sp/>*<sp/>Licensed<sp/>under<sp/>the<sp/>Apache<sp/>License,<sp/>Version<sp/>2.0<sp/>(the<sp/>&quot;License&quot;);</highlight></codeline>
<codeline lineno="5"><highlight class="comment"><sp/>*<sp/>you<sp/>may<sp/>not<sp/>use<sp/>this<sp/>file<sp/>except<sp/>in<sp/>compliance<sp/>with<sp/>the<sp/>License.</highlight></codeline>
<codeline lineno="6"><highlight class="comment"><sp/>*<sp/>You<sp/>may<sp/>obtain<sp/>a<sp/>copy<sp/>of<sp/>the<sp/>License<sp/>at</highlight></codeline>
<codeline lineno="7"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="8"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/>http://www.apache.org/licenses/LICENSE-2.0</highlight></codeline>
<codeline lineno="9"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="10"><highlight class="comment"><sp/>*<sp/>Unless<sp/>required<sp/>by<sp/>applicable<sp/>law<sp/>or<sp/>agreed<sp/>to<sp/>in<sp/>writing,<sp/>software</highlight></codeline>
<codeline lineno="11"><highlight class="comment"><sp/>*<sp/>distributed<sp/>under<sp/>the<sp/>License<sp/>is<sp/>distributed<sp/>on<sp/>an<sp/>&quot;AS<sp/>IS&quot;<sp/>BASIS,</highlight></codeline>
<codeline lineno="12"><highlight class="comment"><sp/>*<sp/>WITHOUT<sp/>WARRANTIES<sp/>OR<sp/>CONDITIONS<sp/>OF<sp/>ANY<sp/>KIND,<sp/>either<sp/>express<sp/>or<sp/>implied.</highlight></codeline>
<codeline lineno="13"><highlight class="comment"><sp/>*<sp/>See<sp/>the<sp/>License<sp/>for<sp/>the<sp/>specific<sp/>language<sp/>governing<sp/>permissions<sp/>and</highlight></codeline>
<codeline lineno="14"><highlight class="comment"><sp/>*<sp/>limitations<sp/>under<sp/>the<sp/>License.</highlight></codeline>
<codeline lineno="15"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="16"><highlight class="normal"></highlight><highlight class="preprocessor">#pragma<sp/>once</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="17"><highlight class="normal"></highlight></codeline>
<codeline lineno="18"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;cuda_runtime_api.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="19"><highlight class="normal"></highlight></codeline>
<codeline lineno="20"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="embedding_8h" kindref="compound">wholememory/embedding.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="21"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="wholememory__tensor_8h" kindref="compound">wholememory/wholememory_tensor.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="22"><highlight class="normal"></highlight></codeline>
<codeline lineno="23"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>__cplusplus</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="24"><highlight class="normal"></highlight><highlight class="keyword">extern</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;C&quot;</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="25"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="26"><highlight class="normal"></highlight></codeline>
<codeline lineno="27" refid="structwholememory__embedding__cache__policy__" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structwholememory__embedding__cache__policy__" kindref="compound">wholememory_embedding_cache_policy_</ref><sp/>{</highlight></codeline>
<codeline lineno="28" refid="structwholememory__embedding__cache__policy___1afcb03b09d8c4bc2131d69c8ebb3d7844" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="structwholememory__comm__" kindref="compound">wholememory_comm_t</ref><sp/><ref refid="structwholememory__embedding__cache__policy___1afcb03b09d8c4bc2131d69c8ebb3d7844" kindref="member">cache_comm</ref><sp/>=<sp/></highlight><highlight class="keyword">nullptr</highlight><highlight class="normal">;<sp/><sp/></highlight><highlight class="comment">//<sp/>nullptr<sp/>means<sp/>only<sp/>use<sp/>local<sp/>GPU</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="29" refid="structwholememory__embedding__cache__policy___1a65ddb2d3cc06296928e016630a5e30d7" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="wholememory_8h_1a58cc0d50d4f407e416d73b7a806aff50" kindref="member">wholememory_memory_type_t</ref><sp/><ref refid="structwholememory__embedding__cache__policy___1a65ddb2d3cc06296928e016630a5e30d7" kindref="member">cache_memory_type</ref>;</highlight></codeline>
<codeline lineno="30" refid="structwholememory__embedding__cache__policy___1ab93c38bcae66c6fbd791bfa87f0ebaab" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="wholememory_8h_1aaab2c1ef14fcbfffce91ce5856c5d9fe" kindref="member">wholememory_memory_location_t</ref><sp/><ref refid="structwholememory__embedding__cache__policy___1ab93c38bcae66c6fbd791bfa87f0ebaab" kindref="member">cache_memory_location</ref>;</highlight></codeline>
<codeline lineno="31" refid="structwholememory__embedding__cache__policy___1a076c1af8a58e192ca95ed0123c3509a7" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="embedding_8h_1ae44b3c6add27a9ccc2b663994860c27a" kindref="member">wholememory_access_type_t</ref><sp/><ref refid="structwholememory__embedding__cache__policy___1a076c1af8a58e192ca95ed0123c3509a7" kindref="member">access_type</ref>;</highlight></codeline>
<codeline lineno="32" refid="structwholememory__embedding__cache__policy___1a929216ff656a607a34b16351445211e8" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/><ref refid="structwholememory__embedding__cache__policy___1a929216ff656a607a34b16351445211e8" kindref="member">cache_ratio</ref><sp/>=<sp/>0.2F;</highlight></codeline>
<codeline lineno="33"><highlight class="normal">};</highlight></codeline>
<codeline lineno="34"><highlight class="normal"></highlight></codeline>
<codeline lineno="35"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>__cplusplus</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="36"><highlight class="normal">}</highlight></codeline>
<codeline lineno="37"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="38"><highlight class="normal"></highlight></codeline>
<codeline lineno="39"><highlight class="normal"></highlight><highlight class="keyword">namespace<sp/></highlight><highlight class="normal"><ref refid="namespacewholememory" kindref="compound">wholememory</ref><sp/>{</highlight></codeline>
<codeline lineno="40"><highlight class="normal"></highlight></codeline>
<codeline lineno="41" refid="classwholememory_1_1embedding__cache__local__data" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classwholememory_1_1embedding__cache__local__data" kindref="compound">embedding_cache_local_data</ref><sp/>{</highlight></codeline>
<codeline lineno="42"><highlight class="normal"><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="43" refid="classwholememory_1_1embedding__cache__local__data_1aa17256cf866a507e32576e8af0ba4f19" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="classwholememory_1_1embedding__cache__local__data_1aa17256cf866a507e32576e8af0ba4f19" kindref="member">embedding_cache_local_data</ref>()<sp/>=<sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="44"><highlight class="normal"><sp/><sp/><ref refid="classwholememory_1_1embedding__cache__local__data_1ab3ec81fe95f3e83d215dd8994f59e7bb" kindref="member">~embedding_cache_local_data</ref>();</highlight></codeline>
<codeline lineno="45"><highlight class="normal"></highlight></codeline>
<codeline lineno="46" refid="classwholememory_1_1embedding__cache__local__data_1ac25c6ce50373760b702329120837fc62" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="wholememory__tensor_8h_1a27285cc111a63f4203830dcdef17e1d9" kindref="member">wholememory_tensor_t</ref><sp/><ref refid="classwholememory_1_1embedding__cache__local__data_1ac25c6ce50373760b702329120837fc62" kindref="member">cache_line_tag_</ref><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="keyword">nullptr</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="47" refid="classwholememory_1_1embedding__cache__local__data_1adad684be61e71cf6e617b26a847a835f" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="wholememory__tensor_8h_1a27285cc111a63f4203830dcdef17e1d9" kindref="member">wholememory_tensor_t</ref><sp/><ref refid="classwholememory_1_1embedding__cache__local__data_1adad684be61e71cf6e617b26a847a835f" kindref="member">cache_line_lfu_count_</ref><sp/>=<sp/></highlight><highlight class="keyword">nullptr</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="48" refid="classwholememory_1_1embedding__cache__local__data_1a33a091f28fb3b55ed64a1f0a6cd7497f" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="wholememory__tensor_8h_1a27285cc111a63f4203830dcdef17e1d9" kindref="member">wholememory_tensor_t</ref><sp/><ref refid="classwholememory_1_1embedding__cache__local__data_1a33a091f28fb3b55ed64a1f0a6cd7497f" kindref="member">cache_line_data_</ref><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="keyword">nullptr</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="49" refid="classwholememory_1_1embedding__cache__local__data_1a0d02ec413f5ccfddb8839cd11f4bd9ba" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="wholememory__tensor_8h_1a27285cc111a63f4203830dcdef17e1d9" kindref="member">wholememory_tensor_t</ref><sp/><ref refid="classwholememory_1_1embedding__cache__local__data_1a0d02ec413f5ccfddb8839cd11f4bd9ba" kindref="member">access_count_</ref><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="keyword">nullptr</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="50"><highlight class="normal">};</highlight></codeline>
<codeline lineno="51"><highlight class="normal"></highlight></codeline>
<codeline lineno="52" refid="classwholememory_1_1embedding__cache__base" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classwholememory_1_1embedding__cache__base" kindref="compound">embedding_cache_base</ref><sp/>{</highlight></codeline>
<codeline lineno="53"><highlight class="normal"><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="54"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">explicit</highlight><highlight class="normal"><sp/><ref refid="classwholememory_1_1embedding__cache__base_1a2ba51fc5bc640a8829c4764b10eccef8" kindref="member">embedding_cache_base</ref>(<ref refid="structwholememory__embedding__cache__policy__" kindref="compound">wholememory_embedding_cache_policy_t</ref><sp/>cache_policy);</highlight></codeline>
<codeline lineno="55" refid="classwholememory_1_1embedding__cache__base_1a2ba51fc5bc640a8829c4764b10eccef8" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="classwholememory_1_1embedding__cache__base_1a2ba51fc5bc640a8829c4764b10eccef8" kindref="member">embedding_cache_base</ref>()<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="56" refid="classwholememory_1_1embedding__cache__base_1afa8f0c1a373bc0c8080990b563856b04" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="classwholememory_1_1embedding__cache__base_1afa8f0c1a373bc0c8080990b563856b04" kindref="member">embedding_cache_base</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classwholememory_1_1embedding__cache__base" kindref="compound">embedding_cache_base</ref>&amp;)<sp/>=<sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="57"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">virtual</highlight><highlight class="normal"><sp/><ref refid="classwholememory_1_1embedding__cache__base_1ac95f250dfa94bfa7744ff0e3c5b41842" kindref="member">~embedding_cache_base</ref>();</highlight></codeline>
<codeline lineno="58"><highlight class="normal"></highlight></codeline>
<codeline lineno="59" refid="classwholememory_1_1embedding__cache__base_1a2b0a7895e894e276e8915ecc38460b2e" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="classwholememory_1_1embedding__cache__local__data" kindref="compound">embedding_cache_local_data</ref>*<sp/><ref refid="classwholememory_1_1embedding__cache__base_1a2b0a7895e894e276e8915ecc38460b2e" kindref="member">get_cache_local_data</ref>()<sp/>{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>&amp;<ref refid="classwholememory_1_1embedding__cache__base_1a7ad2058cf6de7e8e70184e8daf6d4750" kindref="member">local_cache_</ref>;<sp/>}</highlight></codeline>
<codeline lineno="60" refid="classwholememory_1_1embedding__cache__base_1afe9710536ec09e9e43f7b60602702eb5" refkind="member"><highlight class="normal"><sp/><sp/>[[nodiscard]]<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classwholememory_1_1embedding__cache__base_1afe9710536ec09e9e43f7b60602702eb5" kindref="member">get_cache_set_coverage</ref>()</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classwholememory_1_1embedding__cache__base_1aa514c769be785f00e0aec49a3304d652" kindref="member">cache_set_coverage_</ref>;<sp/>}</highlight></codeline>
<codeline lineno="61"><highlight class="normal"></highlight></codeline>
<codeline lineno="62" refid="classwholememory_1_1embedding__cache__base_1a5b091018fae6e5ae5846114edc926c08" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">virtual</highlight><highlight class="normal"><sp/><ref refid="wholememory_8h_1a2ee1891c60edb29e6e88ee67c5f161a2" kindref="member">wholememory_error_code_t</ref><sp/><ref refid="classwholememory_1_1embedding__cache__base_1a5b091018fae6e5ae5846114edc926c08" kindref="member">get_embedding_requirement</ref>(</highlight></codeline>
<codeline lineno="63"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structwholememory__tensor__description__t" kindref="compound">wholememory_tensor_description_t</ref>*<sp/>padded_desc,</highlight></codeline>
<codeline lineno="64"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structwholememory__matrix__description__t" kindref="compound">wholememory_matrix_description_t</ref><sp/>data_desc,</highlight></codeline>
<codeline lineno="65"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structwholememory__comm__" kindref="compound">wholememory_comm_t</ref><sp/>comm,</highlight></codeline>
<codeline lineno="66"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="wholememory_8h_1a58cc0d50d4f407e416d73b7a806aff50" kindref="member">wholememory_memory_type_t</ref><sp/>memory_type,</highlight></codeline>
<codeline lineno="67"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="wholememory_8h_1aaab2c1ef14fcbfffce91ce5856c5d9fe" kindref="member">wholememory_memory_location_t</ref><sp/>memory_location)<sp/>noexcept<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="68"><highlight class="normal"></highlight></codeline>
<codeline lineno="69"><highlight class="normal"><sp/><sp/><ref refid="wholememory_8h_1a2ee1891c60edb29e6e88ee67c5f161a2" kindref="member">wholememory_error_code_t</ref><sp/><ref refid="classwholememory_1_1embedding__cache__base_1a8da5f29aa1655c0660c070ac0221f3a3" kindref="member">allocate</ref>(<ref refid="wholememory__tensor_8h_1a27285cc111a63f4203830dcdef17e1d9" kindref="member">wholememory_tensor_t</ref><sp/>raw_data_tensor)<sp/>noexcept;</highlight></codeline>
<codeline lineno="70"><highlight class="normal"></highlight></codeline>
<codeline lineno="71"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">virtual</highlight><highlight class="normal"><sp/><ref refid="wholememory_8h_1a2ee1891c60edb29e6e88ee67c5f161a2" kindref="member">wholememory_error_code_t</ref><sp/><ref refid="classwholememory_1_1embedding__cache__base_1a43f5a089fc9de52ede11fe2a10a0342c" kindref="member">writeback_all_cache</ref>(cudaStream_t<sp/>stream)<sp/>noexcept;</highlight></codeline>
<codeline lineno="72"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">virtual</highlight><highlight class="normal"><sp/><ref refid="wholememory_8h_1a2ee1891c60edb29e6e88ee67c5f161a2" kindref="member">wholememory_error_code_t</ref><sp/><ref refid="classwholememory_1_1embedding__cache__base_1a1494c7df36538cb6503daf1c4b8244fc" kindref="member">drop_all_cache</ref>(cudaStream_t<sp/>stream)<sp/>noexcept;</highlight></codeline>
<codeline lineno="73"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>wholememory_error_code_t<sp/>refill_all_cache(cudaStream_t<sp/>stream)<sp/>noexcept;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="74"><highlight class="normal"></highlight></codeline>
<codeline lineno="75" refid="classwholememory_1_1embedding__cache__base_1adfae37216b342efe0ea5cd235a2ae431" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>constexpr<sp/>int64_t<sp/><ref refid="classwholememory_1_1embedding__cache__base_1adfae37216b342efe0ea5cd235a2ae431" kindref="member">kEmbeddingAlignmentInBytes</ref><sp/>=<sp/>16;</highlight></codeline>
<codeline lineno="76" refid="classwholememory_1_1embedding__cache__base_1ac28940a30c2491153dd539784006b9fc" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>constexpr<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classwholememory_1_1embedding__cache__base_1ac28940a30c2491153dd539784006b9fc" kindref="member">kCacheSetSize</ref><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>32;</highlight></codeline>
<codeline lineno="77"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Tag<sp/>format:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="78"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>1<sp/>bit<sp/>Valid,<sp/>1<sp/>bit<sp/>Modified,<sp/>14<sp/>bit<sp/>indice.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="79" refid="classwholememory_1_1embedding__cache__base_1a27842656a46659c378b17ede43d4c500" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>constexpr<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classwholememory_1_1embedding__cache__base_1a27842656a46659c378b17ede43d4c500" kindref="member">kCacheSetCoverageBits</ref><sp/><sp/><sp/><sp/>=<sp/>14;<sp/><sp/></highlight><highlight class="comment">//<sp/>2<sp/>bits<sp/>left<sp/>for<sp/>modified<sp/>and<sp/>valid<sp/>state</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="80" refid="classwholememory_1_1embedding__cache__base_1a65f0367a67bf344cd9ff29f19d6dcf67" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>constexpr<sp/>uint16_t<sp/><ref refid="classwholememory_1_1embedding__cache__base_1a65f0367a67bf344cd9ff29f19d6dcf67" kindref="member">kvalidCacheTagValue</ref><sp/>=<sp/>1U<sp/>&lt;&lt;<sp/>(<ref refid="classwholememory_1_1embedding__cache__base_1a27842656a46659c378b17ede43d4c500" kindref="member">kCacheSetCoverageBits</ref><sp/>+<sp/>1);</highlight></codeline>
<codeline lineno="81" refid="classwholememory_1_1embedding__cache__base_1ab6b1328910442f346c74ce6647b508ac" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>constexpr<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classwholememory_1_1embedding__cache__base_1ab6b1328910442f346c74ce6647b508ac" kindref="member">kMaxCacheSetCoverage</ref><sp/><sp/><sp/><sp/><sp/>=<sp/>1<sp/>&lt;&lt;<sp/><ref refid="classwholememory_1_1embedding__cache__base_1a27842656a46659c378b17ede43d4c500" kindref="member">kCacheSetCoverageBits</ref>;</highlight></codeline>
<codeline lineno="82"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Counter<sp/>format:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="83"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>14<sp/>bit<sp/>scaled<sp/>counter,<sp/>2<sp/>bit<sp/>per<sp/>thread<sp/>(64<sp/>bit<sp/>per<sp/>set)<sp/>set<sp/>scaling<sp/>info.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="84" refid="classwholememory_1_1embedding__cache__base_1a260a7e2b471e903443d5261de2241f15" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>constexpr<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classwholememory_1_1embedding__cache__base_1a260a7e2b471e903443d5261de2241f15" kindref="member">kScaledCounterBits</ref><sp/>=</highlight></codeline>
<codeline lineno="85"><highlight class="normal"><sp/><sp/><sp/><sp/>14;<sp/><sp/></highlight><highlight class="comment">//<sp/>2<sp/>bits<sp/>(64<sp/>bits<sp/>in<sp/>set)<sp/>left<sp/>for<sp/>scale<sp/>and<sp/>reserved</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="86"><highlight class="normal"></highlight></codeline>
<codeline lineno="87"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>cache<sp/>related<sp/>tensor</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="88" refid="classwholememory_1_1embedding__cache__base_1a42296cc962c3ddbdb7a6c45057647685" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="wholememory__tensor_8h_1a27285cc111a63f4203830dcdef17e1d9" kindref="member">wholememory_tensor_t</ref><sp/><ref refid="classwholememory_1_1embedding__cache__base_1a42296cc962c3ddbdb7a6c45057647685" kindref="member">cache_line_tag_wm_tensor_</ref><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="keyword">nullptr</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="89" refid="classwholememory_1_1embedding__cache__base_1a68ea8e32e42a628f1452c2a3118b5db8" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="wholememory__tensor_8h_1a27285cc111a63f4203830dcdef17e1d9" kindref="member">wholememory_tensor_t</ref><sp/><ref refid="classwholememory_1_1embedding__cache__base_1a68ea8e32e42a628f1452c2a3118b5db8" kindref="member">cache_line_lfu_count_wm_tensor_</ref><sp/>=<sp/></highlight><highlight class="keyword">nullptr</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="90" refid="classwholememory_1_1embedding__cache__base_1ad6a09990fe92ff8087785299623aa5e3" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="wholememory__tensor_8h_1a27285cc111a63f4203830dcdef17e1d9" kindref="member">wholememory_tensor_t</ref><sp/><ref refid="classwholememory_1_1embedding__cache__base_1ad6a09990fe92ff8087785299623aa5e3" kindref="member">cache_line_data_wm_tensor_</ref><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="keyword">nullptr</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="91" refid="classwholememory_1_1embedding__cache__base_1ac855262c539fb5a74157df6a8f416abb" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="wholememory__tensor_8h_1a27285cc111a63f4203830dcdef17e1d9" kindref="member">wholememory_tensor_t</ref><sp/><ref refid="classwholememory_1_1embedding__cache__base_1ac855262c539fb5a74157df6a8f416abb" kindref="member">access_count_wm_tensor_</ref><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="keyword">nullptr</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="92"><highlight class="normal"></highlight></codeline>
<codeline lineno="93"><highlight class="normal"><sp/></highlight><highlight class="keyword">protected</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="94"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classwholememory_1_1embedding__cache__base_1a911b7b877893fba917df073fe3a8aba0" kindref="member">pad_last_dim</ref>(<ref refid="structwholememory__matrix__description__t" kindref="compound">wholememory_matrix_description_t</ref><sp/>data_desc)<sp/>noexcept;</highlight></codeline>
<codeline lineno="95"><highlight class="normal"><sp/><sp/><ref refid="wholememory_8h_1a2ee1891c60edb29e6e88ee67c5f161a2" kindref="member">wholememory_error_code_t</ref><sp/><ref refid="classwholememory_1_1embedding__cache__base_1a354f2c9c13876a230b839cf1f739a6de" kindref="member">compute_cache_set_coverage</ref>()<sp/>noexcept;</highlight></codeline>
<codeline lineno="96"><highlight class="normal"><sp/><sp/><ref refid="wholememory_8h_1a2ee1891c60edb29e6e88ee67c5f161a2" kindref="member">wholememory_error_code_t</ref><sp/><ref refid="classwholememory_1_1embedding__cache__base_1af3d25495d982e7c54bea7759f31b116d" kindref="member">check_raw_tensor</ref>(<ref refid="wholememory__tensor_8h_1a27285cc111a63f4203830dcdef17e1d9" kindref="member">wholememory_tensor_t</ref><sp/>raw_data_tensor)<sp/>noexcept;</highlight></codeline>
<codeline lineno="97"><highlight class="normal"></highlight></codeline>
<codeline lineno="98" refid="classwholememory_1_1embedding__cache__base_1ac5eca7da27c56d420205ec3821af7444" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="structwholememory__matrix__description__t" kindref="compound">wholememory_matrix_description_t</ref><sp/><ref refid="classwholememory_1_1embedding__cache__base_1ac5eca7da27c56d420205ec3821af7444" kindref="member">padded_matrix_description_</ref>;</highlight></codeline>
<codeline lineno="99" refid="classwholememory_1_1embedding__cache__base_1a2a6c1d733b80405102cba63cc6b66c7d" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="structwholememory__matrix__description__t" kindref="compound">wholememory_matrix_description_t</ref><sp/><ref refid="classwholememory_1_1embedding__cache__base_1a2a6c1d733b80405102cba63cc6b66c7d" kindref="member">matrix_description_</ref>;</highlight></codeline>
<codeline lineno="100"><highlight class="normal"></highlight></codeline>
<codeline lineno="101" refid="classwholememory_1_1embedding__cache__base_1ad1eaad957bacff626c278ef2e2fc4f7d" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="wholememory__tensor_8h_1a27285cc111a63f4203830dcdef17e1d9" kindref="member">wholememory_tensor_t</ref><sp/><ref refid="classwholememory_1_1embedding__cache__base_1ad1eaad957bacff626c278ef2e2fc4f7d" kindref="member">padded_raw_tensor_</ref><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="keywordtype">nullptr</highlight><highlight class="normal">;<sp/><sp/></highlight><highlight class="comment">//<sp/>just<sp/>a<sp/>reference,<sp/>not<sp/>owned</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="102" refid="classwholememory_1_1embedding__cache__base_1ac635d86cea9fd1266715e63980ecbb9e" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="structwholememory__comm__" kindref="compound">wholememory_comm_t</ref><sp/><ref refid="classwholememory_1_1embedding__cache__base_1ac635d86cea9fd1266715e63980ecbb9e" kindref="member">raw_comm_</ref><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="keywordtype">nullptr</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="103" refid="classwholememory_1_1embedding__cache__base_1aeba7fd3d8661e7f7ffc3c62f6f732364" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="wholememory_8h_1a58cc0d50d4f407e416d73b7a806aff50" kindref="member">wholememory_memory_type_t</ref><sp/><ref refid="classwholememory_1_1embedding__cache__base_1aeba7fd3d8661e7f7ffc3c62f6f732364" kindref="member">raw_memory_type_</ref><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/><ref refid="wholememory_8h_1a58cc0d50d4f407e416d73b7a806aff50a4590b351fca36aa4365d26bec0be0ea8" kindref="member">WHOLEMEMORY_MT_NONE</ref>;</highlight></codeline>
<codeline lineno="104" refid="classwholememory_1_1embedding__cache__base_1a731e2fa0c03c5c912d8e218296678f64" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="wholememory_8h_1aaab2c1ef14fcbfffce91ce5856c5d9fe" kindref="member">wholememory_memory_location_t</ref><sp/><ref refid="classwholememory_1_1embedding__cache__base_1a731e2fa0c03c5c912d8e218296678f64" kindref="member">raw_memory_location_</ref><sp/>=<sp/><ref refid="wholememory_8h_1aaab2c1ef14fcbfffce91ce5856c5d9fead7f045a859dafe2dc9e34b952ecead80" kindref="member">WHOLEMEMORY_ML_NONE</ref>;</highlight></codeline>
<codeline lineno="105"><highlight class="normal"></highlight></codeline>
<codeline lineno="106" refid="classwholememory_1_1embedding__cache__base_1a6303ed95b5fac4353748f77d64271fdf" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="structwholememory__embedding__cache__policy__" kindref="compound">wholememory_embedding_cache_policy_t</ref><sp/><ref refid="classwholememory_1_1embedding__cache__base_1a6303ed95b5fac4353748f77d64271fdf" kindref="member">cache_policy_</ref><sp/>=<sp/></highlight><highlight class="keywordtype">nullptr</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="107"><highlight class="normal"></highlight></codeline>
<codeline lineno="108" refid="classwholememory_1_1embedding__cache__base_1aa514c769be785f00e0aec49a3304d652" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classwholememory_1_1embedding__cache__base_1aa514c769be785f00e0aec49a3304d652" kindref="member">cache_set_coverage_</ref><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/><ref refid="classwholememory_1_1embedding__cache__base_1ac28940a30c2491153dd539784006b9fc" kindref="member">kCacheSetSize</ref>;</highlight></codeline>
<codeline lineno="109" refid="classwholememory_1_1embedding__cache__base_1ac1de068ec1ddca1736068f36a4e88b02" refkind="member"><highlight class="normal"><sp/><sp/>int64_t<sp/><ref refid="classwholememory_1_1embedding__cache__base_1ac1de068ec1ddca1736068f36a4e88b02" kindref="member">padded_embedding_count_for_cache_</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="110"><highlight class="normal"></highlight></codeline>
<codeline lineno="111" refid="classwholememory_1_1embedding__cache__base_1a7ad2058cf6de7e8e70184e8daf6d4750" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="classwholememory_1_1embedding__cache__local__data" kindref="compound">embedding_cache_local_data</ref><sp/><ref refid="classwholememory_1_1embedding__cache__base_1a7ad2058cf6de7e8e70184e8daf6d4750" kindref="member">local_cache_</ref>;</highlight></codeline>
<codeline lineno="112"><highlight class="normal">};</highlight></codeline>
<codeline lineno="113"><highlight class="normal"></highlight></codeline>
<codeline lineno="114" refid="classwholememory_1_1device__cache__for__host" refkind="compound"><highlight class="normal">class<sp/><ref refid="classwholememory_1_1device__cache__for__host" kindref="compound">device_cache_for_host</ref><sp/>:<sp/>public<sp/><ref refid="classwholememory_1_1embedding__cache__base" kindref="compound">embedding_cache_base</ref><sp/>{</highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><ref refid="classwholememory_1_1device__cache__for__host" kindref="compound">device_cache_for_host</ref>(<ref refid="structwholememory__embedding__cache__policy__" kindref="compound">wholememory_embedding_cache_policy_t</ref><sp/>cache_policy);</highlight></codeline>
<codeline lineno="117" refid="classwholememory_1_1device__cache__for__host_1a3563a7755ba5e1332ac193416037beb4" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="classwholememory_1_1device__cache__for__host_1a3563a7755ba5e1332ac193416037beb4" kindref="member">device_cache_for_host</ref>()<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="118" refid="classwholememory_1_1device__cache__for__host_1a0a87f6261f9126b787b0395c4656622f" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="classwholememory_1_1device__cache__for__host_1a0a87f6261f9126b787b0395c4656622f" kindref="member">device_cache_for_host</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classwholememory_1_1device__cache__for__host" kindref="compound">device_cache_for_host</ref>&amp;)<sp/>=<sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/>~<ref refid="classwholememory_1_1device__cache__for__host" kindref="compound">device_cache_for_host</ref>();</highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/><ref refid="wholememory_8h_1a2ee1891c60edb29e6e88ee67c5f161a2" kindref="member">wholememory_error_code_t</ref><sp/><ref refid="classwholememory_1_1embedding__cache__base_1a5b091018fae6e5ae5846114edc926c08" kindref="member">get_embedding_requirement</ref>(</highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structwholememory__tensor__description__t" kindref="compound">wholememory_tensor_description_t</ref>*<sp/>padded_desc,</highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structwholememory__matrix__description__t" kindref="compound">wholememory_matrix_description_t</ref><sp/>data_desc,</highlight></codeline>
<codeline lineno="123"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structwholememory__comm__" kindref="compound">wholememory_comm_t</ref><sp/>comm,</highlight></codeline>
<codeline lineno="124"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="wholememory_8h_1a58cc0d50d4f407e416d73b7a806aff50" kindref="member">wholememory_memory_type_t</ref><sp/>memory_type,</highlight></codeline>
<codeline lineno="125"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="wholememory_8h_1aaab2c1ef14fcbfffce91ce5856c5d9fe" kindref="member">wholememory_memory_location_t</ref><sp/>memory_location)<sp/>noexcept<sp/></highlight><highlight class="keyword">override</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="126"><highlight class="normal"><sp/><sp/><ref refid="wholememory_8h_1a2ee1891c60edb29e6e88ee67c5f161a2" kindref="member">wholememory_error_code_t</ref><sp/><ref refid="classwholememory_1_1embedding__cache__base_1a43f5a089fc9de52ede11fe2a10a0342c" kindref="member">writeback_all_cache</ref>(cudaStream_t<sp/>stream)<sp/>noexcept<sp/></highlight><highlight class="keyword">override</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="127"><highlight class="normal"><sp/><sp/><ref refid="wholememory_8h_1a2ee1891c60edb29e6e88ee67c5f161a2" kindref="member">wholememory_error_code_t</ref><sp/><ref refid="classwholememory_1_1embedding__cache__base_1a1494c7df36538cb6503daf1c4b8244fc" kindref="member">drop_all_cache</ref>(cudaStream_t<sp/>stream)<sp/>noexcept<sp/></highlight><highlight class="keyword">override</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="128"><highlight class="normal">};</highlight></codeline>
<codeline lineno="129"><highlight class="normal"></highlight></codeline>
<codeline lineno="130" refid="classwholememory_1_1local__cache__for__global" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classwholememory_1_1local__cache__for__global" kindref="compound">local_cache_for_global</ref><sp/>:<sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/><ref refid="classwholememory_1_1embedding__cache__base" kindref="compound">embedding_cache_base</ref><sp/>{</highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="132"><highlight class="normal"><sp/><sp/><ref refid="classwholememory_1_1local__cache__for__global" kindref="compound">local_cache_for_global</ref>(<ref refid="structwholememory__embedding__cache__policy__" kindref="compound">wholememory_embedding_cache_policy_t</ref><sp/>cache_policy);</highlight></codeline>
<codeline lineno="133" refid="classwholememory_1_1local__cache__for__global_1ab092995d1ad610ce6bc12d48f836b334" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="classwholememory_1_1local__cache__for__global_1ab092995d1ad610ce6bc12d48f836b334" kindref="member">local_cache_for_global</ref>()<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="134" refid="classwholememory_1_1local__cache__for__global_1a95a92e2669842119177fabe82e484570" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="classwholememory_1_1local__cache__for__global_1a95a92e2669842119177fabe82e484570" kindref="member">local_cache_for_global</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classwholememory_1_1local__cache__for__global" kindref="compound">local_cache_for_global</ref>&amp;)<sp/>=<sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="135"><highlight class="normal"><sp/><sp/>~<ref refid="classwholememory_1_1local__cache__for__global" kindref="compound">local_cache_for_global</ref>();</highlight></codeline>
<codeline lineno="136"><highlight class="normal"><sp/><sp/><ref refid="wholememory_8h_1a2ee1891c60edb29e6e88ee67c5f161a2" kindref="member">wholememory_error_code_t</ref><sp/><ref refid="classwholememory_1_1embedding__cache__base_1a5b091018fae6e5ae5846114edc926c08" kindref="member">get_embedding_requirement</ref>(</highlight></codeline>
<codeline lineno="137"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structwholememory__tensor__description__t" kindref="compound">wholememory_tensor_description_t</ref>*<sp/>padded_desc,</highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structwholememory__matrix__description__t" kindref="compound">wholememory_matrix_description_t</ref><sp/>data_desc,</highlight></codeline>
<codeline lineno="139"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structwholememory__comm__" kindref="compound">wholememory_comm_t</ref><sp/>comm,</highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="wholememory_8h_1a58cc0d50d4f407e416d73b7a806aff50" kindref="member">wholememory_memory_type_t</ref><sp/>memory_type,</highlight></codeline>
<codeline lineno="141"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="wholememory_8h_1aaab2c1ef14fcbfffce91ce5856c5d9fe" kindref="member">wholememory_memory_location_t</ref><sp/>memory_location)<sp/>noexcept<sp/></highlight><highlight class="keyword">override</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="142"><highlight class="normal"><sp/><sp/><ref refid="wholememory_8h_1a2ee1891c60edb29e6e88ee67c5f161a2" kindref="member">wholememory_error_code_t</ref><sp/><ref refid="classwholememory_1_1embedding__cache__base_1a1494c7df36538cb6503daf1c4b8244fc" kindref="member">drop_all_cache</ref>(cudaStream_t<sp/>stream)<sp/>noexcept<sp/></highlight><highlight class="keyword">override</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="143"><highlight class="normal">};</highlight></codeline>
<codeline lineno="144"><highlight class="normal"></highlight></codeline>
<codeline lineno="145"><highlight class="normal">}<sp/><sp/></highlight><highlight class="comment">//<sp/>namespace<sp/>wholememory</highlight><highlight class="normal"></highlight></codeline>
    </programlisting>
    <location file="src/wholememory/embedding_cache.hpp"/>
  </compounddef>
</doxygen>
